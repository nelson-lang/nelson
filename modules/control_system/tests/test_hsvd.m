%=============================================================================
% Copyright (c) 2023-present Allan CORNET (Nelson)
%=============================================================================
% This file is part of the Nelson.
%=============================================================================
% LICENCE_BLOCK_BEGIN
% SPDX-License-Identifier: LGPL-3.0-or-later
% LICENCE_BLOCK_END
%=============================================================================
A = [ -0.04165  0.0000  4.9200  -4.9200  0.0000  0.0000  0.0000;
-5.2100  -12.500  0.0000   0.0000  0.0000  0.0000  0.0000;
0.0000   3.3300 -3.3300   0.0000  0.0000  0.0000  0.0000;
0.5450   0.0000  0.0000   0.0000 -0.5450  0.0000  0.0000;
0.0000   0.0000  0.0000   4.9200 -0.04165 0.0000  4.9200;
0.0000   0.0000  0.0000   0.0000 -5.2100 -12.500  0.0000;
0.0000   0.0000  0.0000   0.0000  0.0000  3.3300 -3.3300];

B = [  0.0000   0.0000;
12.5000   0.0000;
0.0000   0.0000;
0.0000   0.0000;
0.0000   0.0000;
0.0000   12.500;
0.0000   0.0000];

C = [1.0000   0.0000  0.0000   0.0000  0.0000  0.0000  0.0000;
0.0000   0.0000  0.0000   1.0000  0.0000  0.0000  0.0000;
0.0000   0.0000  0.0000   0.0000  1.0000  0.0000  0.0000];

D = []; 

sys = ss (A, B, C, D);
R = hsvd(sys);

REF = [2.5139;
2.0846;
1.9178;
0.7666;
0.5473;
0.0253;
0.0246];

assert_isapprox(R, REF, 1e-4);
%=============================================================================
A = [ -0.04165  0.0000  4.9200  -4.9200  0.0000  0.0000  0.0000;
-5.2100  -12.500  0.0000   0.0000  0.0000  0.0000  0.0000;
0.0000   3.3300 -3.3300   0.0000  0.0000  0.0000  0.0000;
0.5450   0.0000  0.0000   0.0000 -0.5450  0.0000  0.0000;
0.0000   0.0000  0.0000   49.200 -0.04165 0.0000  4.9200;
0.0000   0.0000  0.0000   0.0000 -5.2100 -12.500  0.0000;
0.0000   0.0000  0.0000   0.0000  0.0000  3.3300 -3.3300];

B = [  0.0000   0.0000;
12.5000   0.0000;
0.0000   0.0000;
0.0000   0.0000;
0.0000   0.0000;
0.0000   125.00;
0.0000   0.0000];

C = [  1.0000   0.0000  0.0000   0.0000  0.0000  0.0000  0.0000;
0.0000   0.0000  0.0000   10.0000  0.0000  0.0000  0.0000;
0.0000   0.0000  0.0000   0.0000  1.0000  0.0000  0.0000];

D = [];
sys = ss(A, B, C, D);
R = hsvd(sys);
REF = [134.4973;
133.3166;
4.9789;
2.7787;
1.3100;
0.2454;
0.0312];
assert_isapprox(R, REF, 1e-4);
%=============================================================================

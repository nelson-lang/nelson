%=============================================================================
% Copyright (c) 2023-present Allan CORNET (Nelson)
%=============================================================================
% This file is part of the Nelson.
%=============================================================================
% LICENCE_BLOCK_BEGIN
% SPDX-License-Identifier: LGPL-3.0-or-later
% LICENCE_BLOCK_END
%=============================================================================
A = [1 2; 3 4];
B = [1 0; 0 1];
C = [1 1; 1 1];
D = [0 0; 0 0];
sys = ss(A, B, C, D);
R = inv(sys);
A_REF = [    1     2     1     0;
3     4     0     1;
1     1     0     0;
1     1     0     0];
B_REF = [0     0; 0     0;-1     0;0    -1];
C_REF = [     0     0     1     0;0     0     0     1];
D_REF = zeros(2, 2);
E_REF = [1     0     0     0;
    0     1     0     0;
    0     0     0     0;
    0     0     0     0];
REF = ss(A_REF, B_REF, C_REF, D_REF);
REF.E = E_REF;
assert_isequal(R, REF);
%=============================================================================

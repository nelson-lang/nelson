%=============================================================================
% Copyright (c) 2016-present Allan CORNET (Nelson)
%=============================================================================
% This file is part of Nelson.
%=============================================================================
% LICENCE_BLOCK_BEGIN
% SPDX-License-Identifier: LGPL-3.0-or-later
% LICENCE_BLOCK_END
%=============================================================================
assert_isequal(class(rms(single(3i),'default')), 'single');
assert_isequal(rms(single(3i)), single(3));
%=============================================================================
assert_isequal(class(rms(single(3i),'double')), 'double');
%=============================================================================
assert_isequal(class(rms(true,'native')), 'double');
assert_isequal(rms(true,'native'), 1);
%=============================================================================
M = [ 8    1    6;
3    5    7;
4    9    2];
R = rms(M);
REF = [5.4467    5.9722    5.4467];
assert_isapprox(R, REF, 1e-4);
%=============================================================================
R = rms(M, 2);
REF = [5.8023; 5.2599; 5.8023];
assert_isapprox(R, REF, 1e-4);
%=============================================================================
M = [ 8    1    6; 
3    5    7;
4    9    2];
R = rms(M, 4);
REF = M;
assert_isequal(R, REF);
%=============================================================================
M = [10:30:70; 20:30:80; 30:30:90];
R = rms(M);
REF = [21.6025   50.6623   80.4156];
assert_isapprox(R, REF, 1e-4);
%=============================================================================
M = [true,false;true,true];
R = rms(M);
REF = [1.0 0.70710678];
assert_isapprox(R, REF, 1e-4);
%=============================================================================
M = [1:3:7;2:3:8;3:3:9];
M(:,:,2) = [10:3:16;11:3:17;12:3:18];
R = rms(M, 3);
REF = [7.1063    9.6177   12.3491
    7.9057   10.5119   13.2853
    8.7464   11.4237   14.2302];
assert_isapprox(R, REF, 1e-3);
%=============================================================================
M = single([12 15 18; 13 16 19; 14 17 20]);
R = rms(M, 'all', 'native');
REF = single(16.2070);
assert_isapprox(R, REF, 1e-3);
%=============================================================================
x = [1.77 -0.005 nan -2.95; nan 0.34 nan 0.19];
R = rms(x,"omitnan");
REF = [1.7700    0.2404       NaN    2.0903];
assert_isapprox(R, REF, 1e-4);
%=============================================================================

<?xml version="1.0" encoding="UTF-8" ?>
<xmldoc>
  <copyright>SAME AS NELSON SOFTWARE</copyright>
  <language>en_US</language>
  <keyword>findpeaks</keyword>
  <short_description
  >Locate local maxima (peaks) in a 1-D signal.</short_description>
  <syntax>
    <syntax_item>[pks, locs, widths, prominences] = findpeaks(Y)</syntax_item>
    <syntax_item
    >[pks, locs, widths, prominences] = findpeaks(Y, Fs, ...)</syntax_item>
    <syntax_item
    >[pks, locs, widths, prominences] = findpeaks(Y, X, ...)</syntax_item>
  </syntax>
  <param_input>
    <param_input_item>
      <param_name>Y</param_name>
      <param_description
      >vector: input signal (row or column)</param_description>
    </param_input_item>
    <param_input_item>
      <param_name>Fs</param_name>
      <param_description
      >scalar: sampling frequency (optional). If provided, peak locations are returned in time units.</param_description>
    </param_input_item>
    <param_input_item>
      <param_name>X</param_name>
      <param_description
      >vector: x-values corresponding to Y (optional). Must have same length as Y.</param_description>
    </param_input_item>
    <param_input_item>
      <param_name>Name/Value pairs</param_name>
      <param_description>name/value options:<ul><li><b
            >MinPeakHeight</b>: numeric scalar, default -Inf</li><li><b
            >MinPeakProminence</b>: numeric scalar &gt;= 0, default 0</li><li><b
            >Threshold</b>: numeric scalar &gt;= 0 (min vertical distance from neighbor baseline), default 0</li><li
          ><b>MinPeakWidth</b>: numeric scalar &gt;= 0, default 0</li><li><b
            >MaxPeakWidth</b>: numeric scalar &gt;= 0, default Inf</li><li><b
            >MinPeakDistance</b>: numeric scalar &gt;= 0 (in same units as X), default 0</li><li
          ><b>WidthReference</b>: 'halfprom' (default) or 'halfheight'</li><li
          ><b>SortStr</b>: 'none' (default), 'ascend' or 'descend'</li><li><b
            >NPeaks</b>: positive integer, maximum number of peaks to return (default Inf)</li><li
          ><b
            >Annotate</b>: 'peaks' (default) or 'extents' (controls plotting annotation)</li></ul></param_description>
    </param_input_item>
  </param_input>
  <param_output>
    <param_output_item>
      <param_name>pks</param_name>
      <param_description>peak amplitudes</param_description>
    </param_output_item>
    <param_output_item>
      <param_name>locs</param_name>
      <param_description
      >peak locations (x-values or indices)</param_description>
    </param_output_item>
    <param_output_item>
      <param_name>widths</param_name>
      <param_description
      >peak widths measured at the specified WidthReference</param_description>
    </param_output_item>
    <param_output_item>
      <param_name>prominences</param_name>
      <param_description>prominence of each peak</param_description>
    </param_output_item>
  </param_output>
  <description>
    <p><b
      >findpeaks</b> locates local maxima (peaks) in a one-dimensional signal Y.</p>
    <p
    >The algorithm detects candidate peaks, filters them by height and threshold, computes prominence and widths, enforces minimum separation, and returns the requested outputs.</p>
    <p
    >When no outputs are requested, the function plots the signal and marks detected peaks.</p>
  </description>
  <examples>
    <example_item>
      <example_item_type>nelson</example_item_type>
      <example_item_description
      >Find peaks in a simple signal</example_item_description>
      <example_item_data
        runnable="cli"
      ><![CDATA[
t = 0:0.01:2*pi;
y = sin(5*t) + 0.2*randn(size(t));
findpeaks(y, t, 'MinPeakProminence', 0.3);
]]></example_item_data>
    </example_item>
    <example_item>
      <example_item_type>nelson</example_item_type>
      <example_item_description
      >Return widths and prominences</example_item_description>
      <example_item_data
        runnable="cli"
      ><![CDATA[
[pks, locs, widths, proms] = findpeaks(y, 'MinPeakHeight', 0);
]]></example_item_data>
    </example_item>
  </examples>
  <see_also>
    <see_also_item>
      <link linkend="${data_analysis}max">max</link>
    </see_also_item>
  </see_also>
  <history>
    <history_item>
      <history_version>1.15.0</history_version>
      <history_description>initial version</history_description>
    </history_item>
  </history>
  <authors>
    <author_item>Allan CORNET</author_item>
  </authors>
</xmldoc>

%=============================================================================
% Copyright (c) 2016-present Allan CORNET (Nelson)
%=============================================================================
% This file is part of Nelson.
%=============================================================================
% LICENCE_BLOCK_BEGIN
% SPDX-License-Identifier: LGPL-3.0-or-later
% LICENCE_BLOCK_END
%=============================================================================
assert_isequal(nargin('cart2sph'), -1);
assert_isequal(nargout('cart2sph'), -1);
%=============================================================================
x = [1 1 1 1; -1 -1 -1 -1];
y = [1 1 -1 -1; 1 1 -1 -1];
z = [1 -1 1 -1; 1 -1 1 -1];
[az, el, r] = cart2sph(x, y, z);
az_REF = [0.7854    0.7854   -0.7854   -0.7854;
2.3562    2.3562   -2.3562   -2.3562];
el_REF = [0.6155   -0.6155    0.6155   -0.6155;
0.6155   -0.6155    0.6155   -0.6155];
r_REF = [1.7321    1.7321    1.7321    1.7321;
1.7321    1.7321    1.7321    1.7321];
assert_isapprox(az, az_REF, 1e-4);
assert_isapprox(el, el_REF, 1e-4);
assert_isapprox(r, r_REF, 1e-4);
%=============================================================================